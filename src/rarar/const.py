"""Constants for RARAR."""

# Default chunk size for searching and reading
DEFAULT_CHUNK_SIZE = 4096
HTTP_CHUNK_SIZE = 32768
MAX_SEARCH_SIZE = 2**20

# RAR marker and block types
RAR3_MARKER = b"\x52\x61\x72\x21\x1a\x07\x00"
RAR5_MARKER = b"\x52\x61\x72\x21\x1a\x07\x01\x00"

# RAR3 block types
RAR3_BLOCK_FILE = 0x74
RAR3_BLOCK_HEADER = 0x73
RAR3_BLOCK_MARKER = 0x72
RAR3_BLOCK_END = 0x7B

# RAR5 block types
RAR5_BLOCK_MAIN = 1
RAR5_BLOCK_FILE = 2
RAR5_BLOCK_SERVICE = 3
RAR5_BLOCK_ENCRYPTION = 4
RAR5_BLOCK_END = 5

# Header flags
RAR3_FLAG_DIRECTORY = 0xE0
RAR3_FLAG_HAS_HIGH_SIZE = 0x100
RAR3_FLAG_HAS_UNICODE_NAME = 0x200
RAR3_FLAG_HAS_DATA = 0x8000

# RAR5 header flags
RAR5_FLAG_EXTRA_PRESENT = 0x0001
RAR5_FLAG_DATA_PRESENT = 0x0002
RAR5_FLAG_SKIP_IF_UNKNOWN = 0x0004
RAR5_FLAG_DATA_CONTINUES = 0x0008
RAR5_FLAG_DATA_CONTINUES_NEXT = 0x0010
RAR5_FLAG_DEPENDENT = 0x0020
RAR5_FLAG_PRESERVE_CHILD = 0x0040

# RAR5 block flags
RAR5_BLOCK_FLAG_EXTRA_DATA = 0x0001
RAR5_BLOCK_FLAG_DATA_AREA = 0x0002
RAR5_BLOCK_FLAG_SKIP_IF_UNKNOWN = 0x0004
RAR5_BLOCK_FLAG_SPLIT_BEFORE = 0x0008
RAR5_BLOCK_FLAG_SPLIT_AFTER = 0x0010
RAR5_BLOCK_FLAG_DEPENDS_PREV = 0x0020
RAR5_BLOCK_FLAG_KEEP_WITH_PARENT = 0x0040

# RAR5 main archive flags
RAR5_MAIN_FLAG_ISVOL = 0x0001
RAR5_MAIN_FLAG_HAS_VOLNR = 0x0002
RAR5_MAIN_FLAG_SOLID = 0x0004
RAR5_MAIN_FLAG_RECOVERY = 0x0008
RAR5_MAIN_FLAG_LOCKED = 0x0010

# RAR5 file flags
RAR5_FILE_FLAG_DIRECTORY = 0x0001
RAR5_FILE_FLAG_HAS_MTIME = 0x0002
RAR5_FILE_FLAG_HAS_CRC32 = 0x0004
RAR5_FILE_FLAG_UNKNOWN_SIZE = 0x0008

RAR5_COMPR_SOLID = 0x40

RAR5_ENC_FLAG_HAS_CHECKVAL = 0x01

RAR5_ENDARC_FLAG_NEXT_VOL = 0x01

RAR5_XFILE_ENCRYPTION = 1
RAR5_XFILE_HASH = 2
RAR5_XFILE_TIME = 3
RAR5_XFILE_VERSION = 4
RAR5_XFILE_REDIR = 5
RAR5_XFILE_OWNER = 6
RAR5_XFILE_SERVICE = 7

RAR5_XTIME_UNIXTIME = 0x01
RAR5_XTIME_HAS_MTIME = 0x02
RAR5_XTIME_HAS_CTIME = 0x04
RAR5_XTIME_HAS_ATIME = 0x08
RAR5_XTIME_UNIXTIME_NS = 0x10

RAR5_XENC_CIPHER_AES256 = 0

RAR5_XENC_CHECKVAL = 0x01
RAR5_XENC_TWEAKED = 0x02

RAR5_XHASH_BLAKE2SP = 0

RAR5_XREDIR_UNIX_SYMLINK = 1
RAR5_XREDIR_WINDOWS_SYMLINK = 2
RAR5_XREDIR_WINDOWS_JUNCTION = 3
RAR5_XREDIR_HARD_LINK = 4
RAR5_XREDIR_FILE_COPY = 5

RAR5_XREDIR_ISDIR = 0x01

RAR5_XOWNER_UNAME = 0x01
RAR5_XOWNER_GNAME = 0x02
RAR5_XOWNER_UID = 0x04
RAR5_XOWNER_GID = 0x08

RAR5_OS_WINDOWS = 0
RAR5_OS_UNIX = 1

DOS_MODE_ARCHIVE = 0x20
DOS_MODE_DIR = 0x10
DOS_MODE_SYSTEM = 0x04
DOS_MODE_HIDDEN = 0x02
DOS_MODE_READONLY = 0x01

RAR5_PW_CHECK_SIZE = 8
RAR5_PW_SUM_SIZE = 4

RAR3_COMPRESSION_METHODS: dict[int, str] = {
    0x30: "Store",
    0x31: "Fastest",
    0x32: "Fast",
    0x33: "Normal",
    0x34: "Good",
    0x35: "Best",
}
RAR3_COMPRESSION_METHODS_REVERSE: dict[str, int] = {
    v: k for k, v in RAR3_COMPRESSION_METHODS.items()
}

RAR5_COMPRESSION_METHODS: dict[int, str] = {
    0: "Store",
    1: "Fastest",
    2: "Fast",
    3: "Normal",
    4: "Good",
    5: "Best",
}
RAR5_COMPRESSION_METHODS_REVERSE: dict[str, int] = {
    v: k for k, v in RAR5_COMPRESSION_METHODS.items()
}

RAR5_HOST_OS_TYPES: dict[int, str] = {
    0: "Windows",
    1: "Unix",
}
